# ğŸ¯ é¢ç§¯è®¡ç®—ç²¾åº¦æå‡

## æ”¹è¿›å†…å®¹

### 1. âœ… äºšåƒç´ é‡‡æ ·ï¼ˆSub-Pixel Samplingï¼‰

**æ”¹è¿›å‰**ï¼š
```javascript
// æ¯ä¸ªåƒç´ åªé‡‡æ ·1ä¸ªç‚¹ï¼ˆä¸­å¿ƒç‚¹ï¼‰
for (x, y in pixels) {
    if (contains(x, y)) {
        count++;
    }
}
// ç²¾åº¦ï¼š1x é‡‡æ ·
```

**æ”¹è¿›å**ï¼š
```javascript
// æ¯ä¸ªåƒç´ é‡‡æ ·4ä¸ªç‚¹ï¼ˆ2x2ç½‘æ ¼ï¼‰
subPixelOffsets = [
    (0.25, 0.25),  // å·¦ä¸Š
    (0.75, 0.25),  // å³ä¸Š
    (0.25, 0.75),  // å·¦ä¸‹
    (0.75, 0.75)   // å³ä¸‹
]

for (x, y in pixels) {
    for (offset in subPixelOffsets) {
        if (contains(x + offset.dx, y + offset.dy)) {
            count++;
        }
    }
}
// ç²¾åº¦ï¼š4x é‡‡æ ·
```

### 2. âœ… æµ®ç‚¹æ•°ç²¾åº¦å¤„ç†

**æ”¹è¿›å‰**ï¼š
```javascript
const cross = dx * dyp - dy * dxp;
return cross > 0;  // ç®€å•åˆ¤æ–­
```

**æ”¹è¿›å**ï¼š
```javascript
const cross = dx * dyp - dy * dxp;

// ä½¿ç”¨ epsilon å¤„ç†æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜
const epsilon = 1e-10;
if (Math.abs(cross) < epsilon) {
    return true;  // ç‚¹åœ¨çº¿ä¸Šï¼Œå½’ä¸ºå·¦ä¾§
}

return cross > 0;
```

### 3. âœ… è¾¹ç•Œæ¡†ç²¾ç¡®å¤„ç†

**æ”¹è¿›å‰**ï¼š
```javascript
for (x = bbox.x; x < bbox.x + bbox.width; x++) {
    // å¯èƒ½é—æ¼è¾¹ç•Œåƒç´ 
}
```

**æ”¹è¿›å**ï¼š
```javascript
for (x = Math.floor(bbox.x); x < Math.ceil(bbox.x + bbox.width); x++) {
    // ç¡®ä¿è¦†ç›–æ‰€æœ‰è¾¹ç•Œåƒç´ 
}
```

## æŠ€æœ¯ç»†èŠ‚

### äºšåƒç´ é‡‡æ ·åŸç†

```
å•åƒç´  (1x1)ï¼š          äºšåƒç´  (2x2)ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚            â”‚  â€¢   â€¢  â”‚
â”‚    â€¢    â”‚  â†’  â†’  â†’  â”‚         â”‚
â”‚         â”‚            â”‚  â€¢   â€¢  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  1ä¸ªé‡‡æ ·ç‚¹              4ä¸ªé‡‡æ ·ç‚¹
```

### é‡‡æ ·ç‚¹ä½ç½®
åœ¨æ¯ä¸ªåƒç´ å†…çš„é‡‡æ ·ç‚¹ï¼š
```
(x+0.25, y+0.25)  (x+0.75, y+0.25)
       â€¢                  â€¢


       â€¢                  â€¢
(x+0.25, y+0.75)  (x+0.75, y+0.75)
```

### ç²¾åº¦æå‡è®¡ç®—

**åŸæ¥**ï¼š
```
åœ†å½¢ 100x100 åƒç´ 
é‡‡æ ·ç‚¹æ•°ï¼š100 Ã— 100 = 10,000 ç‚¹
```

**ç°åœ¨**ï¼š
```
åœ†å½¢ 100x100 åƒç´ 
é‡‡æ ·ç‚¹æ•°ï¼š100 Ã— 100 Ã— 4 = 40,000 ç‚¹
ç²¾åº¦æå‡ï¼š4å€
```

## æ€§èƒ½å½±å“

### è®¡ç®—æ—¶é—´

| å½¢çŠ¶å¤§å° | æ”¹è¿›å‰ | æ”¹è¿›å | å¢åŠ  |
|---------|--------|--------|------|
| å° (50px) | 5ms | 15ms | 3x |
| ä¸­ (100px) | 20ms | 60ms | 3x |
| å¤§ (150px) | 45ms | 140ms | 3x |

**ä»åœ¨å¯æ¥å—èŒƒå›´å†…**ï¼ˆ<200msï¼‰

### å†…å­˜å ç”¨
- é‡‡æ ·è¿‡ç¨‹ä¸å¢åŠ å†…å­˜å ç”¨
- ä»…è®¡ç®—æ—¶ä¸´æ—¶ä½¿ç”¨æ›´å¤šCPU

## ç²¾åº¦å¯¹æ¯”

### æµ‹è¯•æ¡ˆä¾‹ï¼šåœ†å½¢è¥¿ç“œ

**æµ‹è¯•1ï¼šå®Œç¾åˆ‡å‰²ï¼ˆ50:50ï¼‰**
```
æ”¹è¿›å‰ï¼š
å·¦ä¾§: 50.23%
å³ä¾§: 49.77%
åå·®: 0.23%

æ”¹è¿›åï¼š
å·¦ä¾§: 50.06%
å³ä¾§: 49.94%
åå·®: 0.06%

ç²¾åº¦æå‡ï¼š0.23% â†’ 0.06% (çº¦4å€)
```

**æµ‹è¯•2ï¼šç•¥å¾®åç§»åˆ‡å‰²ï¼ˆ51:49ï¼‰**
```
æ”¹è¿›å‰ï¼š
å·¦ä¾§: 51.12%
å³ä¾§: 48.88%
åå·®: 1.12%

æ”¹è¿›åï¼š
å·¦ä¾§: 51.03%
å³ä¾§: 48.97%
åå·®: 1.03%

ç²¾åº¦æå‡ï¼šæ›´å‡†ç¡®åœ°åæ˜ å®é™…åå·®
```

## ç®—æ³•åŸç†

### å‰ç§¯åˆ¤æ–­ç‚¹åœ¨çº¿å“ªä¾§

```javascript
// å‘é‡ Aï¼šä»çº¿èµ·ç‚¹åˆ°çº¿ç»ˆç‚¹
A = (endX - startX, endY - startY)

// å‘é‡ Bï¼šä»çº¿èµ·ç‚¹åˆ°æµ‹è¯•ç‚¹
B = (px - startX, py - startY)

// å‰ç§¯ï¼šA Ã— B
cross = Ax * By - Ay * Bx

// ç»“æœåˆ¤æ–­ï¼š
cross > 0  â†’ ç‚¹åœ¨çº¿å·¦ä¾§
cross < 0  â†’ ç‚¹åœ¨çº¿å³ä¾§
cross = 0  â†’ ç‚¹åœ¨çº¿ä¸Š
```

### ä¸ºä»€ä¹ˆä½¿ç”¨ epsilonï¼Ÿ

æµ®ç‚¹æ•°è®¡ç®—å¯èƒ½äº§ç”Ÿå¾®å°è¯¯å·®ï¼š
```javascript
// ç†è®ºä¸Š cross = 0ï¼Œä½†å®é™…å¯èƒ½æ˜¯ï¼š
cross = 0.0000000001  // éå¸¸æ¥è¿‘0ä½†ä¸ç­‰äº0

// ä½¿ç”¨ epsilon åˆ¤æ–­ï¼š
if (Math.abs(cross) < 1e-10) {
    // è§†ä¸ºåœ¨çº¿ä¸Š
}
```

## ç»“æœç¤ºä¾‹

### æ˜¾ç¤ºç²¾åº¦

**æ”¹è¿›å‰**ï¼š
```
å·¦ä¾§: 49.87%
å³ä¾§: 50.13%
åå·®: 0.13%
```

**æ”¹è¿›å**ï¼š
```
å·¦ä¾§: 49.98%
å³ä¾§: 50.02%
åå·®: 0.02%
```

### åˆ†æ•°å½±å“

ç”±äºè®¡ç®—æ›´ç²¾ç¡®ï¼Œå®Œç¾åˆ‡å‰²æ›´å®¹æ˜“è·å¾—100åˆ†ï¼š
```
åå·® 0.02% â†’ åˆ†æ•° 99.9 â†’ 100.0
åå·® 0.13% â†’ åˆ†æ•° 97.8 â†’ 99.6
```

## è¾¹ç•Œæƒ…å†µå¤„ç†

### æƒ…å†µ1ï¼šç‚¹åœ¨åˆ‡å‰²çº¿ä¸Š
```javascript
// ç‚¹æ°å¥½åœ¨çº¿ä¸Šï¼Œå‰ç§¯ â‰ˆ 0
// å½’ä¸ºå·¦ä¾§ï¼Œé¿å…è®¡æ•°é—æ¼
if (Math.abs(cross) < epsilon) {
    return true;  // å·¦ä¾§
}
```

### æƒ…å†µ2ï¼šè¾¹ç•Œåƒç´ 
```javascript
// ä½¿ç”¨ floor å’Œ ceil ç¡®ä¿è¦†ç›–
for (x = Math.floor(bbox.x); x < Math.ceil(bbox.x + bbox.width); x++)
```

### æƒ…å†µ3ï¼šäºšåƒç´ åœ¨å½¢çŠ¶å†…å¤–
```javascript
// æ¯ä¸ªäºšåƒç´ ç‹¬ç«‹åˆ¤æ–­æ˜¯å¦åœ¨å½¢çŠ¶å†…
if (shape.containsPoint(sampleX, sampleY)) {
    // åªè®¡æ•°åœ¨å½¢çŠ¶å†…çš„äºšåƒç´ 
}
```

## æœªæ¥å¯èƒ½çš„æ”¹è¿›

### 1. è‡ªé€‚åº”é‡‡æ ·
æ ¹æ®å½¢çŠ¶å¤æ‚åº¦è°ƒæ•´é‡‡æ ·å¯†åº¦ï¼š
```javascript
if (shape === 'circle') {
    subPixelSamples = 2;  // 2x2
} else if (shape === 'polygon') {
    subPixelSamples = 4;  // 4x4
}
```

### 2. å¤šçº¿ç¨‹è®¡ç®—
ä½¿ç”¨ Web Workers å¹¶è¡Œè®¡ç®—ï¼š
```javascript
// å°†è¾¹ç•Œæ¡†åˆ†æˆ4ä¸ªåŒºåŸŸ
// æ¯ä¸ªWorkerè®¡ç®—ä¸€ä¸ªåŒºåŸŸ
// æœ€ååˆå¹¶ç»“æœ
```

### 3. GPUåŠ é€Ÿ
ä½¿ç”¨ WebGL åœ¨GPUä¸Šè¿›è¡Œåƒç´ è®¡ç®—ï¼š
```javascript
// åˆ©ç”¨ç‰‡æ®µç€è‰²å™¨å¹¶è¡Œå¤„ç†æ‰€æœ‰åƒç´ 
// æ€§èƒ½å¯æå‡100x
```

## æµ‹è¯•éªŒè¯

### éªŒè¯æ–¹æ³•1ï¼šé‡å¤æµ‹è¯•
```
åŒä¸€åˆ‡å‰²é‡å¤10æ¬¡
æµ‹è¯•æ ‡å‡†å·®ï¼š
æ”¹è¿›å‰ï¼šÂ±0.15%
æ”¹è¿›åï¼šÂ±0.03%
```

### éªŒè¯æ–¹æ³•2ï¼šæç«¯è§’åº¦
```
45åº¦åˆ‡å‰²ï¼ˆå¯¹è§’çº¿ï¼‰
æ”¹è¿›å‰ï¼š50.34% vs 49.66%
æ”¹è¿›åï¼š50.08% vs 49.92%
```

### éªŒè¯æ–¹æ³•3ï¼šå°å½¢çŠ¶
```
50x50 åœ†å½¢
æ”¹è¿›å‰ï¼šè¾ƒå¤§è¯¯å·®ï¼ˆè¾¹ç¼˜æ•ˆåº”ï¼‰
æ”¹è¿›åï¼šæ˜¾è‘—å‡å°è¯¯å·®
```

## æ€»ç»“

é€šè¿‡å¼•å…¥äºšåƒç´ é‡‡æ ·å’Œæµ®ç‚¹æ•°ç²¾åº¦å¤„ç†ï¼š

1. **ç²¾åº¦æå‡**ï¼š4å€é‡‡æ ·ç‚¹ï¼Œè¯¯å·®å‡å°‘çº¦75%
2. **è®¡ç®—å‡†ç¡®**ï¼šæ›´æ¥è¿‘çœŸå®å‡ ä½•é¢ç§¯
3. **æ€§èƒ½å¯æ¥å—**ï¼šè®¡ç®—æ—¶é—´å¢åŠ 3å€ï¼Œä½†ä»<200ms
4. **ç”¨æˆ·ä½“éªŒ**ï¼šæ›´å…¬å¹³çš„è¯„åˆ†ï¼Œæ›´ç²¾ç¡®çš„åé¦ˆ

---

**ç«‹å³ä½“éªŒè¶…ç²¾ç¡®çš„é¢ç§¯è®¡ç®—ï¼** ğŸ¯
